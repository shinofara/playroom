# プロダクト要件定義書: Kabu SaaS

## 1. プロダクトビジョン

**「個人投資家の日本株投資を、データドリブンで効率化する」**

兼業投資家が限られた時間の中で、テクニカル分析・ファンダメンタル分析を駆使し、根拠ある売買判断を行えるプラットフォームを提供する。手動で行っていた銘柄スクリーニング・シグナル検出・売買プランニングを自動化し、投資判断の質と速度を向上させる。

### 解決する課題

- 銘柄分析に膨大な時間がかかる
- テクニカル指標の計算・監視を手動で行うのは非効率
- 感覚的な売買判断によるリスク管理の甘さ
- ポートフォリオ全体のパフォーマンス把握が困難

---

## 2. ユーザーペルソナ

### ペルソナ: 田中太郎（35歳・兼業投資家）

| 項目 | 詳細 |
|------|------|
| 職業 | IT企業勤務のエンジニア |
| 投資歴 | 3年 |
| 投資スタイル | スイングトレード（数日〜数週間） |
| 運用資金 | 300万〜1,000万円 |
| 投資に使える時間 | 平日30分、休日1〜2時間 |
| 利用デバイス | PC（メイン）、スマホ（確認用） |
| 課題 | 仕事が忙しく銘柄分析の時間が取れない。買い時・売り時の判断に自信がない |
| 期待 | データに基づいた売買シグナルで効率的に投資判断したい |

### ユーザーの典型的なワークフロー

1. 朝の通勤時: ダッシュボードで保有銘柄・ウォッチリストの状況を確認
2. 昼休み: 買いシグナルが出ている銘柄をチェック、売買プランを確認
3. 夕方: 市場クローズ後のデータ更新を待ち、翌日の戦略を検討
4. 週末: ポートフォリオのパフォーマンスを振り返り、スクリーニングで新規銘柄を探索

---

## 3. 機能一覧（MVPスコープ）

### 3.1 データ収集

#### 3.1.1 株価データ自動収集

| 項目 | 詳細 |
|------|------|
| 概要 | yfinanceを使用して日本株の日足データを自動収集する |
| データソース | yfinance API |
| 対象市場 | 東証プライム・スタンダード・グロース |
| 収集データ | 始値、高値、安値、終値、出来高、調整後終値 |
| 収集頻度 | 日次（市場クローズ後に自動実行） |
| 保存期間 | 過去5年分 |
| 初期データ | 初回起動時に過去5年分を一括取得 |

#### 3.1.2 銘柄マスタ管理

| 項目 | 詳細 |
|------|------|
| 概要 | 日本株の銘柄情報を管理する |
| 管理項目 | 銘柄コード、銘柄名、業種、市場区分、セクター |
| 更新頻度 | 週次（上場廃止・新規上場の反映） |
| 初期データ | 東証上場銘柄一覧から一括登録 |

#### 3.1.3 ファンダメンタルデータ収集

| 項目 | 詳細 |
|------|------|
| 概要 | 銘柄のファンダメンタル指標を収集する |
| 収集項目 | PER, PBR, 配当利回り, ROE, EPS, BPS, 時価総額, 売上高, 営業利益 |
| データソース | yfinance API |
| 収集頻度 | 日次 |

### 3.2 テクニカル分析

#### 3.2.1 移動平均線（SMA / EMA）

| 項目 | 詳細 |
|------|------|
| SMA | 5日, 25日, 75日, 200日移動平均線 |
| EMA | 12日, 26日指数移動平均線 |
| 判定 | ゴールデンクロス、デッドクロス、パーフェクトオーダーの検出 |

#### 3.2.2 RSI（相対力指数）

| 項目 | 詳細 |
|------|------|
| 期間 | 14日（デフォルト） |
| 判定 | 30以下で売られすぎ、70以上で買われすぎ |
| ダイバージェンス | 価格とRSIの乖離を検出 |

#### 3.2.3 MACD

| 項目 | 詳細 |
|------|------|
| パラメータ | 短期EMA: 12日, 長期EMA: 26日, シグナル: 9日 |
| 判定 | MACDラインとシグナルラインのクロス、ヒストグラムの変化 |

#### 3.2.4 ボリンジャーバンド

| 項目 | 詳細 |
|------|------|
| 期間 | 20日 |
| バンド幅 | ±1σ, ±2σ, ±3σ |
| 判定 | バンドウォーク、スクイーズ、ブレイクアウトの検出 |

#### 3.2.5 出来高分析

| 項目 | 詳細 |
|------|------|
| 指標 | 出来高移動平均（25日）、出来高比率 |
| 判定 | 出来高急増（平均の2倍以上）、価格変動との相関 |

### 3.3 ファンダメンタル分析

| 指標 | 説明 | 判定基準（目安） |
|------|------|------------------|
| PER | 株価収益率 | 15倍以下で割安 |
| PBR | 株価純資産倍率 | 1.0倍以下で割安 |
| 配当利回り | 年間配当 / 株価 | 3%以上で高配当 |
| ROE | 自己資本利益率 | 10%以上で効率的 |
| 時価総額 | 企業規模 | フィルタリング用 |

### 3.4 買いシグナル検出

#### スコアリングモデル

各指標にスコア（0〜100）を付与し、加重平均で総合スコアを算出する。

| カテゴリ | 指標 | 重み |
|----------|------|------|
| テクニカル | SMA/EMAクロス | 15% |
| テクニカル | RSI | 10% |
| テクニカル | MACD | 15% |
| テクニカル | ボリンジャーバンド | 10% |
| テクニカル | 出来高 | 10% |
| ファンダメンタル | PER | 10% |
| ファンダメンタル | PBR | 10% |
| ファンダメンタル | 配当利回り | 10% |
| ファンダメンタル | ROE | 10% |

#### シグナル判定

| スコア | 判定 |
|--------|------|
| 80〜100 | 強い買い推奨 |
| 60〜79 | 買い推奨 |
| 40〜59 | 中立 |
| 20〜39 | 弱気 |
| 0〜19 | 売り推奨 |

### 3.5 売りシグナル検出

#### 利確シグナル

- 目標利益率到達（デフォルト: +10%, +20%, +30%）
- テクニカル指標の悪化（デッドクロス、RSI過熱等）
- トレーリングストップ到達

#### 損切りシグナル

- 損切りライン到達（デフォルト: -5%, -10%）
- 重大なテクニカル悪化（複数指標の同時悪化）

### 3.6 ポートフォリオ管理

| 機能 | 詳細 |
|------|------|
| 保有銘柄管理 | 銘柄、取得単価、保有数量、取得日の登録 |
| 損益計算 | 評価損益、実現損益、損益率の自動計算 |
| パフォーマンス追跡 | 日次・週次・月次のリターン推移 |
| 資産配分 | セクター別・銘柄別の資産配分表示 |
| 取引履歴 | 売買履歴の記録・閲覧 |

### 3.7 売買プラン

| 項目 | 詳細 |
|------|------|
| エントリーポイント | テクニカル分析に基づく推奨購入価格 |
| 利確ライン | 段階的な利確目標（+10%, +20%, +30%） |
| 損切りライン | リスク許容度に応じた損切り価格 |
| ポジションサイズ | 総資金に対する推奨投資比率（リスク管理ベース） |
| リスクリワード比 | 期待リターン / 最大リスクの比率表示 |

### 3.8 ダッシュボード

| 表示項目 | 詳細 |
|----------|------|
| マーケット概況 | 日経平均、TOPIX、為替の現在値と変動率 |
| ポートフォリオサマリ | 総資産、総損益、日次変動 |
| 買いシグナル一覧 | スコア上位の銘柄リスト（上位10件） |
| 売りシグナル一覧 | 保有銘柄の売りシグナル |
| ウォッチリスト | 注目銘柄の最新状況 |
| 直近の取引 | 直近の売買履歴 |

### 3.9 スクリーニング

#### フィルタ条件

| カテゴリ | 条件 |
|----------|------|
| 市場 | プライム / スタンダード / グロース |
| 業種 | セクター選択 |
| 株価 | 範囲指定（○円〜○円） |
| 時価総額 | 範囲指定 |
| PER | 範囲指定 |
| PBR | 範囲指定 |
| 配当利回り | 範囲指定 |
| ROE | 範囲指定 |
| RSI | 範囲指定 |
| 出来高 | 最低出来高指定 |
| 買いスコア | 最低スコア指定 |

#### ソート・表示

- 複数条件の組み合わせ（AND条件）
- ソート項目の選択（スコア、PER、配当利回り等）
- 検索結果のCSVエクスポート

### 3.10 ウォッチリスト

| 機能 | 詳細 |
|------|------|
| 銘柄登録 | 注目銘柄をウォッチリストに追加 |
| アラート設定 | 買いシグナル発生時に通知（ダッシュボード上） |
| メモ | 銘柄ごとにメモを記録可能 |
| グループ分け | カテゴリ別にグループ管理 |

---

## 4. 画面一覧

### 4.1 ダッシュボード（トップページ）

| 項目 | 詳細 |
|------|------|
| パス | `/` |
| 概要 | 投資状況の全体概要を一覧表示 |
| 主要コンポーネント | マーケット概況カード、ポートフォリオサマリカード、買いシグナルテーブル、売りシグナルテーブル、ウォッチリストミニビュー、直近取引リスト |

### 4.2 銘柄詳細

| 項目 | 詳細 |
|------|------|
| パス | `/stocks/:code` |
| 概要 | 個別銘柄の詳細分析画面 |
| 主要コンポーネント | ローソク足チャート（TradingView風）、テクニカル指標オーバーレイ（SMA, EMA, ボリンジャーバンド）、サブチャート（RSI, MACD, 出来高）、ファンダメンタル指標テーブル、買いスコアゲージ、売買プラン提案パネル |

### 4.3 スクリーニング

| 項目 | 詳細 |
|------|------|
| パス | `/screening` |
| 概要 | 条件指定による銘柄絞り込み |
| 主要コンポーネント | フィルタパネル（左サイドバー）、結果テーブル（ソート・ページネーション付き）、クイックビューモーダル |

### 4.4 ポートフォリオ

| 項目 | 詳細 |
|------|------|
| パス | `/portfolio` |
| 概要 | 保有銘柄とパフォーマンスの管理 |
| 主要コンポーネント | 保有銘柄テーブル（評価損益付き）、資産配分チャート（ドーナツ）、パフォーマンスチャート（折れ線）、取引入力フォーム |

### 4.5 取引履歴

| 項目 | 詳細 |
|------|------|
| パス | `/portfolio/history` |
| 概要 | 過去の売買履歴の閲覧 |
| 主要コンポーネント | 取引一覧テーブル（フィルタ・ソート付き）、損益サマリ |

### 4.6 ウォッチリスト

| 項目 | 詳細 |
|------|------|
| パス | `/watchlist` |
| 概要 | 注目銘柄の監視 |
| 主要コンポーネント | ウォッチリストテーブル、アラート状況バッジ、メモ編集パネル、グループタブ |

### 4.7 売買プラン

| 項目 | 詳細 |
|------|------|
| パス | `/stocks/:code/plan` |
| 概要 | 個別銘柄の売買プラン詳細 |
| 主要コンポーネント | エントリーポイント表示、利確/損切りラインチャート、ポジションサイズ計算機、リスクリワード比表示 |

### 4.8 設定

| 項目 | 詳細 |
|------|------|
| パス | `/settings` |
| 概要 | アプリケーション設定 |
| 主要コンポーネント | スコアリング重み調整、デフォルト利確/損切り率設定、データ収集設定、通知設定 |

---

## 5. データモデル概要

### 5.1 ER図（主要エンティティ）

```
[stocks] 1--* [stock_prices]
[stocks] 1--* [stock_fundamentals]
[stocks] 1--* [technical_indicators]
[stocks] 1--* [signals]
[stocks] *--* [watchlists] (via [watchlist_items])
[stocks] 1--* [portfolio_items]
[portfolio_items] 1--* [transactions]
[users] 1--* [watchlists]
[users] 1--1 [portfolios]
[portfolios] 1--* [portfolio_items]
[users] 1--* [user_settings]
```

### 5.2 主要テーブル定義

#### stocks（銘柄マスタ）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| code | VARCHAR(10) UNIQUE | 銘柄コード（例: "7203.T"） |
| name | VARCHAR(100) | 銘柄名 |
| sector | VARCHAR(50) | 業種 |
| market | VARCHAR(20) | 市場区分 |
| is_active | BOOLEAN | 上場中フラグ |
| created_at | TIMESTAMP | 登録日時 |
| updated_at | TIMESTAMP | 更新日時 |

#### stock_prices（株価日足）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| stock_id | INT FK | 銘柄ID |
| date | DATE | 日付 |
| open | DECIMAL(10,2) | 始値 |
| high | DECIMAL(10,2) | 高値 |
| low | DECIMAL(10,2) | 安値 |
| close | DECIMAL(10,2) | 終値 |
| volume | BIGINT | 出来高 |
| adjusted_close | DECIMAL(10,2) | 調整後終値 |

UNIQUE制約: (stock_id, date)

#### stock_fundamentals（ファンダメンタルデータ）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| stock_id | INT FK | 銘柄ID |
| date | DATE | 取得日 |
| per | DECIMAL(10,2) | PER |
| pbr | DECIMAL(10,2) | PBR |
| dividend_yield | DECIMAL(5,2) | 配当利回り(%) |
| roe | DECIMAL(5,2) | ROE(%) |
| eps | DECIMAL(10,2) | EPS |
| bps | DECIMAL(10,2) | BPS |
| market_cap | BIGINT | 時価総額 |
| revenue | BIGINT | 売上高 |
| operating_income | BIGINT | 営業利益 |

UNIQUE制約: (stock_id, date)

#### technical_indicators（テクニカル指標）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| stock_id | INT FK | 銘柄ID |
| date | DATE | 日付 |
| sma_5 | DECIMAL(10,2) | 5日SMA |
| sma_25 | DECIMAL(10,2) | 25日SMA |
| sma_75 | DECIMAL(10,2) | 75日SMA |
| sma_200 | DECIMAL(10,2) | 200日SMA |
| ema_12 | DECIMAL(10,2) | 12日EMA |
| ema_26 | DECIMAL(10,2) | 26日EMA |
| rsi_14 | DECIMAL(5,2) | 14日RSI |
| macd_line | DECIMAL(10,4) | MACDライン |
| macd_signal | DECIMAL(10,4) | シグナルライン |
| macd_histogram | DECIMAL(10,4) | ヒストグラム |
| bb_upper_2 | DECIMAL(10,2) | ボリンジャー上限(2σ) |
| bb_middle | DECIMAL(10,2) | ボリンジャー中央 |
| bb_lower_2 | DECIMAL(10,2) | ボリンジャー下限(2σ) |
| volume_sma_25 | BIGINT | 出来高25日SMA |

UNIQUE制約: (stock_id, date)

#### signals（シグナル）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| stock_id | INT FK | 銘柄ID |
| date | DATE | シグナル発生日 |
| signal_type | VARCHAR(10) | "buy" / "sell" |
| score | DECIMAL(5,2) | 総合スコア(0-100) |
| technical_score | DECIMAL(5,2) | テクニカルスコア |
| fundamental_score | DECIMAL(5,2) | ファンダメンタルスコア |
| reasons | JSONB | シグナル理由の詳細 |
| created_at | TIMESTAMP | 生成日時 |

#### portfolios（ポートフォリオ）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| user_id | INT FK | ユーザーID |
| name | VARCHAR(50) | ポートフォリオ名 |
| total_investment | DECIMAL(12,2) | 総投資額 |
| created_at | TIMESTAMP | 作成日時 |

#### portfolio_items（保有銘柄）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| portfolio_id | INT FK | ポートフォリオID |
| stock_id | INT FK | 銘柄ID |
| quantity | INT | 保有数量 |
| avg_purchase_price | DECIMAL(10,2) | 平均取得単価 |
| created_at | TIMESTAMP | 登録日時 |
| updated_at | TIMESTAMP | 更新日時 |

#### transactions（取引履歴）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| portfolio_item_id | INT FK | 保有銘柄ID |
| stock_id | INT FK | 銘柄ID |
| transaction_type | VARCHAR(4) | "buy" / "sell" |
| quantity | INT | 数量 |
| price | DECIMAL(10,2) | 約定単価 |
| commission | DECIMAL(8,2) | 手数料 |
| transaction_date | DATE | 約定日 |
| notes | TEXT | メモ |
| created_at | TIMESTAMP | 登録日時 |

#### watchlists（ウォッチリスト）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| user_id | INT FK | ユーザーID |
| name | VARCHAR(50) | リスト名 |
| created_at | TIMESTAMP | 作成日時 |

#### watchlist_items（ウォッチリスト項目）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| watchlist_id | INT FK | ウォッチリストID |
| stock_id | INT FK | 銘柄ID |
| memo | TEXT | メモ |
| alert_enabled | BOOLEAN | アラート有効フラグ |
| added_at | TIMESTAMP | 追加日時 |

#### users（ユーザー）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| username | VARCHAR(50) UNIQUE | ユーザー名 |
| email | VARCHAR(100) UNIQUE | メールアドレス |
| password_hash | VARCHAR(255) | パスワードハッシュ |
| created_at | TIMESTAMP | 登録日時 |

#### user_settings（ユーザー設定）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | SERIAL PK | 内部ID |
| user_id | INT FK | ユーザーID |
| setting_key | VARCHAR(50) | 設定キー |
| setting_value | JSONB | 設定値 |

UNIQUE制約: (user_id, setting_key)

### 5.3 インデックス戦略

| テーブル | インデックス | 目的 |
|----------|-------------|------|
| stock_prices | (stock_id, date DESC) | 銘柄別の直近株価取得 |
| technical_indicators | (stock_id, date DESC) | 銘柄別の直近指標取得 |
| signals | (date DESC, signal_type, score DESC) | シグナル一覧の高速取得 |
| signals | (stock_id, date DESC) | 銘柄別シグナル取得 |
| stock_fundamentals | (stock_id, date DESC) | 銘柄別ファンダメンタル取得 |
| transactions | (portfolio_item_id, transaction_date DESC) | 取引履歴取得 |

---

## 6. 非機能要件

### 6.1 パフォーマンス

| 項目 | 要件 |
|------|------|
| 画面表示 | ダッシュボード初期表示: 3秒以内 |
| API応答 | 通常のAPIレスポンス: 500ms以内 |
| データ収集 | 全銘柄の日足更新: 30分以内 |
| テクニカル分析 | 全銘柄のテクニカル指標計算: 15分以内 |
| スクリーニング | 全銘柄からの絞り込み: 2秒以内 |

### 6.2 セキュリティ

| 項目 | 要件 |
|------|------|
| 認証 | JWT認証（当面は1ユーザーだがマルチユーザー対応の設計） |
| パスワード | bcryptによるハッシュ化 |
| API | CORS設定、レートリミット |
| データ | SQLインジェクション対策（ORM使用） |
| 通信 | ローカル環境のためHTTPで可（将来的にHTTPS対応） |

### 6.3 可用性・運用

| 項目 | 要件 |
|------|------|
| 環境 | ローカルDocker環境で動作 |
| バックアップ | PostgreSQLのpg_dumpによる日次バックアップスクリプト |
| ログ | アプリケーションログ（ファイル出力） |
| モニタリング | ヘルスチェックエンドポイント |
| データ収集の耐障害性 | 失敗時のリトライ（3回）、部分的な失敗でも他銘柄の収集を継続 |

### 6.4 開発・品質

| 項目 | 要件 |
|------|------|
| テスト | ユニットテスト（pytest）、APIテスト |
| コード品質 | Python: ruff / mypy、TypeScript: ESLint / Prettier |
| CI/CD | 当面は手動デプロイ（ローカル環境） |
| ドキュメント | APIドキュメント（FastAPI自動生成） |

---

## 7. フェーズ分け（ロードマップ）

### Phase 1: MVP（4〜6週間）

**目標**: 基本的なデータ収集・分析・表示の仕組みを構築する

| 週 | 内容 |
|----|------|
| Week 1-2 | プロジェクトセットアップ、DB設計、株価データ収集パイプライン |
| Week 3-4 | テクニカル分析エンジン、買い/売りシグナル検出 |
| Week 5-6 | フロントエンド（ダッシュボード、銘柄詳細、スクリーニング） |

**MVPに含まれる機能**:
- データ収集（株価日足、ファンダメンタル）
- テクニカル分析（SMA, RSI, MACD, ボリンジャーバンド, 出来高）
- ファンダメンタル分析（PER, PBR, 配当利回り, ROE）
- 買いシグナル検出（スコアリング）
- ダッシュボード（マーケット概況、シグナル一覧）
- 銘柄詳細画面（チャート、指標表示）
- スクリーニング（基本フィルタ）

### Phase 2: ポートフォリオ・売買プラン（3〜4週間）

**目標**: 実際の投資活動をサポートする機能を追加する

| 機能 | 内容 |
|------|------|
| ポートフォリオ管理 | 保有銘柄登録、損益計算、パフォーマンス追跡 |
| 売買プラン | エントリーポイント、利確/損切りライン、ポジションサイズ提案 |
| 売りシグナル | 保有銘柄に対する売りタイミング提案 |
| ウォッチリスト | 注目銘柄の登録・監視・アラート |
| 取引履歴 | 売買記録の入力・閲覧 |

### Phase 3: 高度な分析・改善（継続的）

**目標**: 分析精度の向上とユーザー体験の改善

| 機能 | 内容 |
|------|------|
| バックテスト | 過去データでの戦略検証 |
| カスタムスコアリング | ユーザーによる重み調整 |
| セクターローテーション分析 | 業種別の強弱分析 |
| ニュース連携 | 株関連ニュースの収集・表示 |
| 銘柄比較 | 複数銘柄の横並び比較 |
| モバイル対応 | レスポンシブデザインの改善 |
| 通知機能 | メール/LINE通知 |
| AIによる分析 | LLMを活用した市場分析・銘柄コメント生成 |

---

## 8. API エンドポイント一覧（MVP）

### 認証

| メソッド | パス | 概要 |
|----------|------|------|
| POST | `/api/auth/login` | ログイン |
| POST | `/api/auth/register` | ユーザー登録 |

### 株価・銘柄

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/stocks` | 銘柄一覧取得（フィルタ・ページネーション） |
| GET | `/api/stocks/:code` | 銘柄詳細取得 |
| GET | `/api/stocks/:code/prices` | 株価履歴取得 |
| GET | `/api/stocks/:code/fundamentals` | ファンダメンタルデータ取得 |
| GET | `/api/stocks/:code/technicals` | テクニカル指標取得 |
| GET | `/api/stocks/:code/signals` | シグナル履歴取得 |
| GET | `/api/stocks/:code/plan` | 売買プラン取得 |

### シグナル

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/signals/buy` | 買いシグナル一覧 |
| GET | `/api/signals/sell` | 売りシグナル一覧 |

### スクリーニング

| メソッド | パス | 概要 |
|----------|------|------|
| POST | `/api/screening` | スクリーニング実行 |

### ポートフォリオ

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/portfolio` | ポートフォリオ取得 |
| POST | `/api/portfolio/items` | 保有銘柄追加 |
| PUT | `/api/portfolio/items/:id` | 保有銘柄更新 |
| DELETE | `/api/portfolio/items/:id` | 保有銘柄削除 |
| GET | `/api/portfolio/performance` | パフォーマンス取得 |
| GET | `/api/portfolio/transactions` | 取引履歴取得 |
| POST | `/api/portfolio/transactions` | 取引記録追加 |

### ウォッチリスト

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/watchlists` | ウォッチリスト一覧 |
| POST | `/api/watchlists` | ウォッチリスト作成 |
| POST | `/api/watchlists/:id/items` | 銘柄追加 |
| DELETE | `/api/watchlists/:id/items/:itemId` | 銘柄削除 |

### ダッシュボード

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/dashboard/summary` | ダッシュボードサマリ |
| GET | `/api/dashboard/market` | マーケット概況 |

### データ管理

| メソッド | パス | 概要 |
|----------|------|------|
| POST | `/api/data/collect` | データ収集手動実行 |
| GET | `/api/data/status` | データ収集状況確認 |

### 設定

| メソッド | パス | 概要 |
|----------|------|------|
| GET | `/api/settings` | 設定取得 |
| PUT | `/api/settings` | 設定更新 |

---

## 9. 技術スタック詳細

| レイヤー | 技術 | 用途 |
|----------|------|------|
| Backend | Python 3.12 + FastAPI | REST API |
| Frontend | Next.js 14 (App Router) + TypeScript | Web UI |
| Database | PostgreSQL 16 | データストア |
| ORM | SQLAlchemy 2.0 | DB操作 |
| データ収集 | yfinance | 株価データ取得 |
| テクニカル分析 | pandas + ta-lib (or pandas-ta) | 指標計算 |
| チャート | Recharts or Lightweight Charts | 株価チャート描画 |
| UIライブラリ | shadcn/ui + Tailwind CSS | UIコンポーネント |
| タスクスケジューラ | APScheduler | 定時データ収集 |
| コンテナ | Docker + Docker Compose | 環境構築 |
| マイグレーション | Alembic | DBマイグレーション |
